<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>First Class - Dekont</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600;700&display=swap" rel="stylesheet">
<!-- html2pdf.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
:root{
    --bg:#f3f6f9;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#0b5ed7;
    --border:#e6e9ee;
    --shadow: 0 8px 22px rgba(16,24,40,0.06);
}
*{box-sizing:border-box}
body{font-family:'Quicksand',sans-serif;background:var(--bg);padding:0;margin:0;color:#0f172a;-webkit-font-smoothing:antialiased;}
.form-wrap{max-width:980px;margin:0 auto 18px;padding:12px;}
.form-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;align-items:end;background:transparent;padding:8px;}
.form-grid .full{grid-column:1 / -1;}
.form-row label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px;}
.form-row input[type="text"], .form-row input[type="email"]{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px;background:#fff;font-size:14px;}
.form-row.actions{display:flex;gap:8px;align-items:center;}
.btn{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600;}
.btn.outline{background:transparent;border:1px solid var(--accent);color:var(--accent);}

/* alert */
.alert{max-width:980px;margin:12px auto;padding:12px;border-radius:8px;background:#fff6f6;border:1px solid #f5c6cb;color:#721c24;}

/* dekont */
.dekont{max-width:900px;margin:18px auto;background:var(--card);border-radius:12px;padding:20px;box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden}
.dekont .dekont-header{position:relative;height:110px;display:block;margin:0;padding:0}
.dekont .logo{height:90px;object-fit:contain}
.dekont .left-logo{position:absolute;left:18px;top:50%;transform:translateY(-50%)}
.dekont .right-logo{position:absolute;right:18px;top:50%;transform:translateY(-50%)}
.dekont .dekont-title{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center;}
.dekont .title-main{font-size:22px;font-weight:700;letter-spacing:0.2px}
.dekont .title-sub{font-size:12px;font-weight:700;color:var(--muted);margin-top:4px;}

/* cards layout */
.top-cards{display:grid;grid-template-columns:1fr 140px;gap:12px;margin-bottom:12px}
.middle-cards{display:block;margin-bottom:12px}
.bottom-cards{display:grid;grid-template-columns:1fr 320px;gap:12px;align-items:start}

/* card styles */
.card{background:linear-gradient(180deg,#fff,#fbfdff);border-radius:10px;padding:14px;border:1px solid var(--border);box-shadow:0 6px 18px rgba(12,20,35,0.04)}
.info-card .row, .wide .row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #f1f3f6}
.info-card .row:last-child, .wide .row:last-child{border-bottom:none}
.label{font-size:12px;color:var(--muted);min-width:160px}
.value{font-size:14px;font-weight:600;word-break:break-word;text-align:right}
.value.left{ text-align:left; }
.mono{font-family:monospace,monospace;font-weight:600;letter-spacing:1px}
.amount{font-size:18px;color:var(--accent);font-weight:700}

/* QR card */
.qr-card{display:flex;align-items:center;justify-content:center;padding:10px}
.qr-img{max-width:120px;height:auto;display:block;border-radius:6px;border:1px solid var(--border)}

/* bottom */
.large{padding:18px}
.info-right{padding:14px;font-size:13px}
.info-right .small{color:var(--muted);margin-top:8px}
.info-right .small-value{font-weight:600}

/* Uyarı */
.alert-red{color:#c53030;font-weight:600;margin-top:18px;font-size:13px}
.alert-red.centered{ text-align:center; }

/* footer */
.dekont-footer{text-align:center;color:var(--muted);font-size:13px;margin-top:14px}

/* responsive */
@media (max-width:900px){
    .form-grid{grid-template-columns:repeat(2,1fr)}
    .top-cards{grid-template-columns:1fr 120px}
    .bottom-cards{grid-template-columns:1fr}
    .info-card .row .label{min-width:120px}
}
@media (max-width:600px){
    .form-grid{grid-template-columns:1fr}
    .dekont .left-logo, .dekont .right-logo{position:static;transform:none;margin:0 auto;display:block;height:56px}
    .dekont .dekont-header{height:auto;padding-top:10px;padding-bottom:10px}
    .dekont .dekont-title{position:static;transform:none;margin:8px 0;text-align:center}
    .top-cards{grid-template-columns:1fr;align-items:center}
    .qr-card{order:2;justify-content:center}
}

/* PRINT STYLES */
@page { size: A4; margin: 10mm; }
@media print{
    body{background:#fff}
    html,body{height:auto}
    .form-wrap, .alert{display:none}
    .dekont{box-shadow:none;border:none;border-radius:0;padding:10mm;margin:0 auto;max-width:100%;width:100% !important}
    .dekont .left-logo, .dekont .right-logo{height:56px}
    .qr-img{max-width:110px}
    body * { visibility: hidden; }
    .dekont, .dekont * { visibility: visible; }
    .dekont { position: absolute; left: 0; top: 0; }
}
</style>
</head>
<body>
<div id="header-placeholder"></div>
<div class="form-wrap">
    <form id="dekontForm" class="form-grid">
        <div class="form-row full">
            <label>Ad Soyad / Ünvan</label>
            <input name="adsoyad" type="text" value="-" required>
        </div>

        <div class="form-row">
            <label>IBAN</label>
            <input id="ibanInput" name="iban" type="text" value="TR00 0000 0000 0000 0000 0000 01" required>
        </div>

        <div class="form-row">
            <label>Tutar</label>
            <input name="tutar" type="text" value="0,00" required>
        </div>

        <div class="form-row full">
            <label>Açıklama</label>
            <input name="aciklama" type="text" value="9415 nolu seri transfer">
        </div>

        <div class="form-row">
            <label>Müşteri Vergi Dairesi</label>
            <input name="vergi_dairesi" type="text" value="AYDIN" required>
        </div>

        <div class="form-row">
            <label>Döviz Cinsi</label>
            <input name="doviz" type="text" value="TL" required>
        </div>

        <div class="form-row actions">
            <button type="button" class="btn" id="showDekont">Dekont Oluştur</button>
            <button type="button" class="btn outline" id="downloadPdf">İndir</button>
        </div>
    </form>
</div>

<div id="dekont" class="dekont">
    <header class="dekont-header">
        <img src="img/yapikredi-logo.jpg" alt="Yapı Kredi" class="logo left-logo">
        <div class="dekont-title">
            <div class="title-main">e-Dekont</div>
            <div class="title-sub">TİCARİ İŞLEM DEKONTU</div>
        </div>
        <img src="img/tc-maliye-bakanligi.png" alt="TC Maliye Bakanlığı" class="logo right-logo">
    </header>

    <section class="top-cards">
        <div class="card info-card">
            <div class="row"><div class="label">MÜŞTERİ NO</div><div class="value">65157476</div></div>
            <div class="row"><div class="label">İŞLEM REF</div><div class="value">603099620453</div></div>
            <div class="row"><div class="label">VKN/TCKN/YKN</div><div class="value">***********</div></div>
            <div class="row"><div class="label">SIRA NO/ID</div><div class="value">- / 2396401434017</div></div>
            <div class="row"><div class="label">IBAN NO</div><div class="value mono" id="ibanDisplay">TR00 0000 0000 0000 0000 0000 01</div></div>
            <div class="row"><div class="label">İŞLEM TARİHİ</div><div class="value" id="islemTarihi"></div></div>
        </div>

        <div class="card qr-card">
            <img src="img/qG9vLt.png" alt="QR" class="qr-img">
        </div>
    </section>

    <section class="middle-cards">
        <div class="card wide">
            <div class="row"><div class="label">HESAP NUMARASI</div><div class="value">52787867 / IBAN: <span id="ibanDisplay2">TR00 0000 0000 0000 0000 0000 01</span></div></div>
            <div class="row"><div class="label">MÜŞTERİ VERGİ DAİRESİ</div><div class="value" id="vdairesiDisplay">AYDIN</div></div>
            <div class="row"><div class="label">DÖVİZ CİNSİ</div><div class="value" id="dovizDisplay">TL</div></div>
            <div class="row"><div class="label">İŞLEM TUTARI</div><div class="value amount" id="tutarDisplay">0,00</div></div>
        </div>
    </section>

    <section class="bottom-cards">
        <div class="card large">
            <div class="label">Alıcı / Ünvan</div>
            <div class="value left" id="adsoyadDisplay">-</div>

            <div class="label" style="margin-top:12px;">Açıklama</div>
            <div class="value left" id="aciklamaDisplay">9415 nolu seri transfer</div>
        </div>

        <div class="card info-right">
            <div class="small">Ticari Unvan</div><div class="small-value">Yapı ve Kredi Bankası A.Ş.</div>
            <div class="small">Büyük Mükellefler VD</div><div class="small-value">9370020892</div>
            <div class="small">Web</div><div class="small-value">www.yapikredi.com.tr</div>
            <div class="small">Ticaret Sicil No</div><div class="small-value">32736</div>
            <div class="small">Adres</div><div class="small-value">Yapı Kredi Plaza D Blok 34330 Levent - İstanbul</div>
            <div class="small">Mersis No</div><div class="small-value">0937002089200741</div>
        </div>
    </section>

    <div class="alert-red centered">
        Para transferiniz alıcının SPK/MASAK özel belge durumu ve vergi beyannamesinin mevcut olmadığından dolayı engellenmiştir.
    </div>

    <footer class="dekont-footer">e-Dekont izni kapsamında elektronik ortamda üretilmiştir.</footer>
</div>

<script>
function formatIban(s){
    s = s.toUpperCase().replace(/[^A-Z0-9]/g, '');
    return s.replace(/(.{4})/g, '$1 ').trim();
}

function formatTutar(s){
    s = s.replace(/\./g,'').replace(',', '.'); // varsa önce noktayı kaldır, virgülü noktaya çevir
    let num = parseFloat(s);
    if(isNaN(num)) num = 0;
    return num.toLocaleString('tr-TR', {minimumFractionDigits:2, maximumFractionDigits:2});
}

document.getElementById('ibanInput').addEventListener('input', function(){
    this.value = formatIban(this.value);
});

document.getElementById('showDekont').addEventListener('click', function(){
    const adsoyad = document.querySelector('input[name="adsoyad"]').value || "-";
    const iban = formatIban(document.querySelector('input[name="iban"]').value) || "TR00 0000 0000 0000 0000 0000 01";
    const tutar = formatTutar(document.querySelector('input[name="tutar"]').value || "0,00");
    const aciklama = document.querySelector('input[name="aciklama"]').value || "9415 nolu seri transfer";
    const vdairesi = document.querySelector('input[name="vergi_dairesi"]').value || "AYDIN";
    const doviz = document.querySelector('input[name="doviz"]').value || "TL";

    document.getElementById('adsoyadDisplay').textContent = adsoyad;
    document.getElementById('ibanDisplay').textContent = iban;
    document.getElementById('ibanDisplay2').textContent = iban;
    document.getElementById('tutarDisplay').textContent = tutar;
    document.getElementById('aciklamaDisplay').textContent = aciklama;
    document.getElementById('vdairesiDisplay').textContent = vdairesi;
    document.getElementById('dovizDisplay').textContent = doviz;

    const today = new Date();
    document.getElementById('islemTarihi').textContent = today.toLocaleDateString('tr-TR');
});

document.getElementById('downloadPdf').addEventListener('click', function(){
    var element = document.getElementById('dekont');
    html2pdf().set({
        margin:10,
        filename:'dekont.pdf',
        html2canvas:{scale:2, useCORS:true, scrollY:0},
        jsPDF:{unit:'mm', format:'a4', orientation:'portrait'}
    }).from(element).save();
});

fetch('assets/header.html')
  .then(response => response.text())
  .then(html => {
    document.getElementById('header-placeholder').innerHTML = html;
  });
</script>

</body>
</html>
